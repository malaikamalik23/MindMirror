{% extends "layout.html" %}
{% block content %}
<div class="container mt-5 fade-in">
  <!-- ‚úÖ Flash Messages -->
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
        <div class="alert alert-{{ category }} rounded shadow-sm">{{ message }}</div>
      {% endfor %}
    {% endif %}
  {% endwith %}

  <!-- üéÄ Login Card -->
  <div class="p-4 p-md-5 bg-white rounded shadow-lg mx-auto" style="max-width: 500px;">
    <form method="POST" action="" autocomplete="off">
      {{ form.hidden_tag() }}
      <h4 class="mb-4 text-center fw-bold">üîê Welcome Back to Mind‚ÄëScribber</h4>

      <!-- Email -->
      <div class="form-group mb-3">
        {{ form.email.label(class="form-label") }}
        {% if form.email.errors %}
          {{ form.email(class="form-control is-invalid", placeholder="you@example.com") }}
          <div class="invalid-feedback">
            {% for error in form.email.errors %}<span>{{ error }}</span>{% endfor %}
          </div>
        {% else %}
          {{ form.email(class="form-control", placeholder="you@example.com") }}
        {% endif %}
      </div>

      <!-- Password -->
      <div class="form-group mb-3">
        {{ form.password.label(class="form-label") }}
        <div class="position-relative">
          {% if form.password.errors %}
            {{ form.password(class="form-control is-invalid", id="password", placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢") }}
            <div class="invalid-feedback">
              {% for error in form.password.errors %}<span>{{ error }}</span>{% endfor %}
            </div>
          {% else %}
            {{ form.password(class="form-control", id="password", placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢") }}
          {% endif %}
          <i class="fas fa-eye position-absolute text-muted" id="togglePassword"
             style="top: 50%; right: 12px; transform: translateY(-50%); cursor: pointer;"></i>
        </div>
      </div>

      <!-- Remember & Forgot -->
      <div class="d-flex justify-content-between align-items-center mb-3">
        <div class="form-check">
          {{ form.remember(class="form-check-input") }}
          {{ form.remember.label(class="form-check-label") }}
        </div>
        <a href="{{ url_for('forgot_password') }}" class="small text-decoration-none text-primary">Forgot Password?</a>
      </div>

      <!-- Submit Button -->
      <div class="d-grid">
        {{ form.submit(class="btn btn-theme btn-lg") }}
      </div>

      <!-- Signup -->
      <div class="text-center mt-4">
        <small class="text-muted">Don't have an account? 
          <a href="{{ url_for('signup') }}" class="text-decoration-none text-primary">Sign up</a>
        </small>
      </div>
    </form>
  </div>
</div>

<!-- üëÅ Toggle Password Script -->
<script>
  const togglePassword = document.getElementById("togglePassword");
  togglePassword.addEventListener("click", function () {
    const password = document.getElementById("password");
    const type = password.type === "password" ? "text" : "password";
    password.type = type;
    this.classList.toggle("fa-eye-slash");
  });
</script>
{% endblock %}
